// -- user code here --

/* --- start generated code --- */

// Generated by  1.5.0 (Phaser v2.6.2)


/**
 * itemShopPrefab.
 * @param {Phaser.Game} aGame A reference to the currently running game.
 * @param {Phaser.Group} aParent The parent Group (or other {@link DisplayObject}) that this group will be added to.    If undefined/unspecified the Group will be added to the {@link Phaser.Game#world Game World}; if null the Group will not be added to any parent.
 * @param {string} aName A name for this group. Not used internally but useful for debugging.
 * @param {boolean} aAddToStage If true this group will be added directly to the Game.Stage instead of Game.World.
 * @param {boolean} aEnableBody If true all Sprites created with {@link #create} or {@link #createMulitple} will have a physics body created on them. Change the body type with {@link #physicsBodyType}.
 * @param {number} aPhysicsBodyType The physics body type to use when physics bodies are automatically added. See {@link #physicsBodyType} for values.
 */
function itemShopPrefab(aGame, aParent, aName, aAddToStage, aEnableBody, aPhysicsBodyType) {
	
	Phaser.Group.call(this, aGame, aParent, aName, aAddToStage, aEnableBody, aPhysicsBodyType);
	var __grp_item_Shop = this.game.add.group(this);
	__grp_item_Shop.position.setTo(0.0, 210.0);
	
	this.game.add.sprite(0.0, -49.0, 'bg_Item_Shop', null, __grp_item_Shop);
	
	var _btn_skin = this.game.add.button(-1.0, 34.0, 'ItemShop1Atlas', null, this, null, 'btn_item_shop_off', null, null, __grp_item_Shop);
	_btn_skin.animations.add('down', ['btn_item_shop_on'], 60, false);
	_btn_skin.animations.add('up', ['btn_item_shop_off'], 60, false);
	
	var _btn_bow = this.game.add.button(350.0, 34.0, 'ItemShop1Atlas', null, this, null, 'btn_item_shop_off', null, null, __grp_item_Shop);
	_btn_bow.animations.add('down', ['btn_item_shop_on'], 60, false);
	_btn_bow.animations.add('up', ['btn_item_shop_off'], 60, false);
	
	var _txt_skin = this.game.add.text(169.0, 55.0, 'SKIN', {"font":"bold 50px Arial","fill":"#ffffff"}, __grp_item_Shop);
	_txt_skin.anchor.setTo(0.5, 0.0);
	
	var _txt_bow = this.game.add.text(536.0, 55.0, 'BOW', {"font":"bold 50px Arial","fill":"#ffffff"}, __grp_item_Shop);
	_txt_bow.anchor.setTo(0.5, 0.0);
	
	var __grp_Skin_Item = this.game.add.group(__grp_item_Shop);
	__grp_Skin_Item.position.setTo(845.0, -316.0);
	
	var _Skin_6 = this.game.add.group(__grp_Skin_Item);
	_Skin_6.position.setTo(457.0, 169.0);
	
	this.game.add.sprite(13.0, 231.0, 'ItemShop1Atlas', 'shop_frame', _Skin_6);
	
	var _Skin_5 = this.game.add.group(__grp_Skin_Item);
	_Skin_5.position.setTo(228.0, 170.0);
	
	this.game.add.sprite(13.0, 231.0, 'ItemShop1Atlas', 'shop_frame', _Skin_5);
	
	var _Skin_4 = this.game.add.group(__grp_Skin_Item);
	_Skin_4.position.setTo(-5.0, 170.0);
	
	this.game.add.sprite(13.0, 231.0, 'ItemShop1Atlas', 'shop_frame', _Skin_4);
	
	var __grp_button_skin_4 = this.game.add.group(_Skin_4);
	
	var _btn_skin_4 = this.game.add.button(26.0, 371.0, 'ItemShop1Atlas', null, this, null, 'BT_buy', null, null, __grp_button_skin_4);
	
	var _txt_skin_4 = this.game.add.text(91.0, 396.0, '20K', {"font":"bold 30px Arial","fill":"#ffffff"}, __grp_button_skin_4);
	
	this.game.add.sprite(77.0, 269.0, 'ItemShop1Atlas', 'skin_04', _Skin_4);
	
	var _Skin_3 = this.game.add.group(__grp_Skin_Item);
	_Skin_3.position.setTo(457.0, -71.0);
	
	this.game.add.sprite(13.0, 231.0, 'ItemShop1Atlas', 'shop_frame', _Skin_3);
	
	var __grp_button_skin_3 = this.game.add.group(_Skin_3);
	
	var _btn_skin_3 = this.game.add.button(26.0, 371.0, 'ItemShop1Atlas', null, this, null, 'BT_buy', null, null, __grp_button_skin_3);
	
	var _txt_skin_3 = this.game.add.text(91.0, 397.0, '15K', {"font":"bold 30px Arial","fill":"#ffffff"}, __grp_button_skin_3);
	
	this.game.add.sprite(79.0, 259.0, 'ItemShop1Atlas', 'skin_03', _Skin_3);
	
	var _Skin_2 = this.game.add.group(__grp_Skin_Item);
	_Skin_2.position.setTo(226.0, -71.0);
	
	this.game.add.sprite(13.0, 231.0, 'ItemShop1Atlas', 'shop_frame', _Skin_2);
	
	var __grp_button_skin_2 = this.game.add.group(_Skin_2);
	
	var _btn_skin_2 = this.game.add.button(26.0, 371.0, 'ItemShop1Atlas', null, this, null, 'BT_buy', null, null, __grp_button_skin_2);
	
	var _txt_skin_2 = this.game.add.text(91.0, 397.0, '10K', {"font":"bold 30px Arial","fill":"#ffffff"}, __grp_button_skin_2);
	
	this.game.add.sprite(83.0, 245.0, 'ItemShop1Atlas', 'skin_02', _Skin_2);
	
	var _Skin_1 = this.game.add.group(__grp_Skin_Item);
	_Skin_1.position.setTo(-4.0, -71.0);
	
	this.game.add.sprite(13.0, 231.0, 'ItemShop1Atlas', 'shop_frame', _Skin_1);
	
	this.game.add.sprite(84.0, 255.0, 'ItemShop1Atlas', 'skin_01', _Skin_1);
	
	var __grp_button_skin_1 = this.game.add.group(_Skin_1);
	
	var _btn_skin_1 = this.game.add.button(26.0, 371.0, 'ItemShop1Atlas', null, this, null, 'BT_buy', null, null, __grp_button_skin_1);
	
	var _txt_skin_1 = this.game.add.text(106.0, 396.0, '5K', {"font":"bold 30px Arial","fill":"#ffffff"}, __grp_button_skin_1);
	
	var _btn_close_item_shop = this.game.add.button(637.0, -25.0, 'HUDAtlas', null, this, null, 'close button', null, null, __grp_item_Shop);
	_btn_close_item_shop.scale.setTo(0.8, 0.8);
	
	var __grp_Bow_Item = this.game.add.group(__grp_item_Shop);
	
	var _Bow_3 = this.game.add.group(__grp_Bow_Item);
	_Bow_3.position.setTo(457.0, -71.0);
	
	this.game.add.sprite(13.0, 231.0, 'ItemShop1Atlas', 'shop_frame', _Bow_3);
	
	var _bow_3 = this.game.add.sprite(74.0, 296.0, 'ItemShop1Atlas', 'bow_03', _Bow_3);
	_bow_3.angle = -29.999999999999996;
	_bow_3.scale.setTo(1.5, 1.5);
	
	var __grp_button_bow_3 = this.game.add.group(_Bow_3);
	
	var _btn_bow_3 = this.game.add.button(26.0, 371.0, 'ItemShop1Atlas', null, this, null, 'BT_buy', null, null, __grp_button_bow_3);
	
	var _txt_bow_3 = this.game.add.text(91.0, 397.0, '20K', {"font":"bold 30px Arial","fill":"#ffffff"}, __grp_button_bow_3);
	
	var _Bow_2 = this.game.add.group(__grp_Bow_Item);
	_Bow_2.position.setTo(226.0, -69.0);
	
	this.game.add.sprite(13.0, 231.0, 'ItemShop1Atlas', 'shop_frame', _Bow_2);
	
	var _bow_2 = this.game.add.sprite(121.0, 333.0, 'ItemShop1Atlas', 'bow_02', _Bow_2);
	_bow_2.angle = -29.999999999999996;
	_bow_2.scale.setTo(0.3, 0.3);
	_bow_2.anchor.setTo(0.5, 0.5);
	
	var __grp_button_bow_2 = this.game.add.group(_Bow_2);
	
	var _btn_bow_2 = this.game.add.button(26.0, 371.0, 'ItemShop1Atlas', null, this, null, 'BT_buy', null, null, __grp_button_bow_2);
	
	var _txt_bow_2 = this.game.add.text(91.0, 397.0, '13K', {"font":"bold 30px Arial","fill":"#ffffff"}, __grp_button_bow_2);
	
	var _Bow_1 = this.game.add.group(__grp_Bow_Item);
	_Bow_1.position.setTo(-4.0, -71.0);
	
	this.game.add.sprite(13.0, 231.0, 'ItemShop1Atlas', 'shop_frame', _Bow_1);
	
	var __grp_button_bow_1 = this.game.add.group(_Bow_1);
	
	var _btn_bow_1 = this.game.add.button(26.0, 371.0, 'ItemShop1Atlas', null, this, null, 'BT_buy', null, null, __grp_button_bow_1);
	
	var _txt_bow_1 = this.game.add.text(106.0, 396.0, '7K', {"font":"bold 30px Arial","fill":"#ffffff"}, __grp_button_bow_1);
	
	var _bow_1 = this.game.add.sprite(129.0, 328.0, 'ItemShop1Atlas', 'bow_01', _Bow_1);
	_bow_1.angle = -29.999999999999996;
	_bow_1.scale.setTo(0.3, 0.3);
	_bow_1.anchor.setTo(0.5, 0.5);
	
	var _Skin_12 = this.game.add.group(__grp_Bow_Item);
	_Skin_12.position.setTo(458.0, 164.0);
	
	this.game.add.sprite(13.0, 231.0, 'ItemShop1Atlas', 'shop_frame', _Skin_12);
	
	var _Skin_11 = this.game.add.group(__grp_Bow_Item);
	_Skin_11.position.setTo(229.0, 165.0);
	
	this.game.add.sprite(13.0, 231.0, 'ItemShop1Atlas', 'shop_frame', _Skin_11);
	
	var _Skin_10 = this.game.add.group(__grp_Bow_Item);
	_Skin_10.position.setTo(-3.0, 166.0);
	
	this.game.add.sprite(13.0, 231.0, 'ItemShop1Atlas', 'shop_frame', _Skin_10);
	
	var __grp_buy_nofti = this.game.add.group(this);
	__grp_buy_nofti.position.setTo(1846.0, 259.0);
	
	var _BG_not_enough_gems = this.game.add.sprite(20.0, 443.0, 'EnvironmentAtlas', 'avatar bar', __grp_buy_nofti);
	
	var _txt_buy_nofti = this.game.add.text(150.0, 563.0, 'Are you sure ?', {"font":"bold 35px Arial","fill":"#ffffff"}, __grp_buy_nofti);
	_txt_buy_nofti.anchor.setTo(0.5, 0.0);
	
	var _btn_buy = this.game.add.button(304.0, 622.0, 'HUDAtlas', null, this, null, 'button 02', null, null, __grp_buy_nofti);
	_btn_buy.scale.setTo(0.7, 0.75);
	
	var _btn_cancel_buy = this.game.add.button(50.0, 640.0, 'HUDAtlas', null, this, null, 'button 02', null, null, __grp_buy_nofti);
	_btn_cancel_buy.scale.setTo(0.45, 0.45);
	
	var _txt_buy_btn = this.game.add.text(206.0, 647.0, 'Yes', {"font":"bold 35px Arial","fill":"#ffffff"}, __grp_buy_nofti);
	_txt_buy_btn.anchor.setTo(0.5, 0.0);
	
	var _txt_cancel_btn = this.game.add.text(524.0, 647.0, 'No', {"font":"bold 35px Arial","fill":"#ffffff"}, __grp_buy_nofti);
	_txt_cancel_btn.anchor.setTo(0.5, 0.0);
	
	var _txt_cost_nofti = this.game.add.text(293.0, 499.0, 'Cost : ', {"font":"bold 35px Arial","fill":"#ffffff"}, __grp_buy_nofti);
	_txt_cost_nofti.anchor.setTo(0.5, 0.0);
	
	var _coin = this.game.add.sprite(447.0, 497.0, 'HUDAtlas', 'coin', __grp_buy_nofti);
	_coin.scale.setTo(0.8, 0.8);
	
	var _txt_value_nofti = this.game.add.text(395.0, 499.0, 'Cost : ', {"font":"bold 35px Arial","fill":"#ffffff"}, __grp_buy_nofti);
	_txt_value_nofti.anchor.setTo(0.5, 0.0);
	
	var __grp_buy_success_nofti = this.game.add.group(this);
	__grp_buy_success_nofti.position.setTo(-1405.0, 663.0);
	
	var _txt_buy_success_nofti = this.game.add.text(376.0, 590.0, 'Buy Success', {"font":"bold 60px Arial","fill":"#fefb00"}, __grp_buy_success_nofti);
	_txt_buy_success_nofti.anchor.setTo(0.5, 0.0);
	
	
	
	// public fields
	
	this.f_grp_item_Shop = __grp_item_Shop;
	this.fBtn_skin = _btn_skin;
	this.fBtn_bow = _btn_bow;
	this.fTxt_skin = _txt_skin;
	this.fTxt_bow = _txt_bow;
	this.f_grp_Skin_Item = __grp_Skin_Item;
	this.fSkin_6 = _Skin_6;
	this.fSkin_5 = _Skin_5;
	this.fSkin_4 = _Skin_4;
	this.f_grp_button_skin_4 = __grp_button_skin_4;
	this.fBtn_skin_4 = _btn_skin_4;
	this.fTxt_skin_4 = _txt_skin_4;
	this.fSkin_3 = _Skin_3;
	this.f_grp_button_skin_3 = __grp_button_skin_3;
	this.fBtn_skin_3 = _btn_skin_3;
	this.fTxt_skin_3 = _txt_skin_3;
	this.fSkin_2 = _Skin_2;
	this.f_grp_button_skin_2 = __grp_button_skin_2;
	this.fBtn_skin_2 = _btn_skin_2;
	this.fTxt_skin_2 = _txt_skin_2;
	this.fSkin_1 = _Skin_1;
	this.f_grp_button_skin_1 = __grp_button_skin_1;
	this.fBtn_skin_1 = _btn_skin_1;
	this.fTxt_skin_1 = _txt_skin_1;
	this.fBtn_close_item_shop = _btn_close_item_shop;
	this.f_grp_Bow_Item = __grp_Bow_Item;
	this.f_grp_button_bow_3 = __grp_button_bow_3;
	this.fBtn_bow_3 = _btn_bow_3;
	this.fTxt_bow_3 = _txt_bow_3;
	this.f_grp_button_bow_2 = __grp_button_bow_2;
	this.fBtn_bow_2 = _btn_bow_2;
	this.fTxt_bow_2 = _txt_bow_2;
	this.f_grp_button_bow_1 = __grp_button_bow_1;
	this.fBtn_bow_1 = _btn_bow_1;
	this.fTxt_bow_1 = _txt_bow_1;
	this.fSkin_12 = _Skin_12;
	this.fSkin_11 = _Skin_11;
	this.fSkin_10 = _Skin_10;
	this.f_grp_buy_nofti = __grp_buy_nofti;
	this.fBG_not_enough_gems = _BG_not_enough_gems;
	this.fTxt_buy_nofti = _txt_buy_nofti;
	this.fBtn_buy = _btn_buy;
	this.fBtn_cancel_buy = _btn_cancel_buy;
	this.fTxt_buy_btn = _txt_buy_btn;
	this.fTxt_cancel_btn = _txt_cancel_btn;
	this.fTxt_cost_nofti = _txt_cost_nofti;
	this.fTxt_value_nofti = _txt_value_nofti;
	this.f_grp_buy_success_nofti = __grp_buy_success_nofti;
	this.fTxt_buy_success_nofti = _txt_buy_success_nofti;
	
	this.Create();
	
}

/** @type Phaser.Group */
var itemShopPrefab_proto = Object.create(Phaser.Group.prototype);
itemShopPrefab.prototype = itemShopPrefab_proto;
itemShopPrefab.prototype.constructor = itemShopPrefab;

/* --- end generated code --- */
// -- user code here --
var MAX_SKIN_ITEM = 5;
var MAX_BOW_ITEM = 4;
itemShopPrefab.prototype.Create = function() {

	this.updateTextAlignCenter();

	this.isBuyItemNotification = false;
	this.ITEMTYPE = {
			SKIN:0,
			BOW:1,
	}
	this.itemType = this.ITEMTYPE.SKIN;
	this.currentItemIndex = -1;
	this.currentItemButton = 0;
	this.prevItemButton = -1;
	this.currentValueItem = -1;
	this.shopButtons = new Array();
	this.shopButtons.push(this.fBtn_skin);
	this.shopButtons.push(this.fBtn_bow);

	this.fBtn_skin.onInputUp.add(this.OnEventSkin, this);
	this.fBtn_bow.onInputUp.add(this.OnEventBow, this);
	this.fBtn_bow.onInputOut.add(this.OnEventOutFrame, this);
	this.fBtn_skin.onInputOut.add(this.OnEventOutFrame, this);
	this.fBtn_close_item_shop.onInputUp.add(this.OnCloseShop, this);
	this.fBtn_cancel_buy.onInputUp.add(this.OnEventCancelBuy, this);
	this.f_grp_Bow_Item.position.setTo(0, 0);
	this.f_grp_Skin_Item.position.setTo(0, 0);
	this.f_grp_buy_nofti.position.setTo(0, 0);
	this.f_grp_buy_success_nofti.position.setTo(0, 0);
	this.activeControlButton(0);

	this.f_grp_Bow_Item.visible = false;
	this.f_grp_Skin_Item.visible = true;
	this.f_grp_buy_nofti.visible = false;
	this.f_grp_buy_success_nofti.visible = false;
	this.buttonSkinItems = new Array();
	this.buttonSkinItems.push(this.fBtn_skin_1);
	this.buttonSkinItems.push(this.fBtn_skin_2);
	this.buttonSkinItems.push(this.fBtn_skin_3);
	this.buttonSkinItems.push(this.fBtn_skin_4);

	
	
	
	// Create Event Button skin item
	this.fBtn_skin_1.onInputUp.add(function() {this.onEventBuySkinItem(0)},this);
	this.fBtn_skin_2.onInputUp.add(function() {this.onEventBuySkinItem(1)},this);
	this.fBtn_skin_3.onInputUp.add(function() {this.onEventBuySkinItem(2)},this);
	this.fBtn_skin_4.onInputUp.add(function() {this.onEventBuySkinItem(3)},this);


	this.buttonBowItems = new Array();
	this.buttonBowItems.push(this.fBtn_bow_1);
	this.buttonBowItems.push(this.fBtn_bow_2);
	// Create Event Button bow item
	this.fBtn_bow_1.onInputUp.add(function() {this.onEventBuyBowItem(0)},this);
	this.fBtn_bow_2.onInputUp.add(function() {this.onEventBuyBowItem(1)},this);
	this.fBtn_bow_3.onInputUp.add(function() {this.onEventBuyBowItem(2)},this);
	// cost of skin item
	this.costSkinItems = new Array();
	this.costSkinItems.push(5000);
	this.costSkinItems.push(10000);
	this.costSkinItems.push(15000);
	this.costSkinItems.push(20000);

	// cost of bow item
	this.costbowItems = new Array();
	this.costbowItems.push(7000);
	this.costbowItems.push(13000);
	this.costbowItems.push(20000);
	//group button buy item
	this.buttonSkinGroups = new Array();
	this.buttonSkinGroups.push(this.f_grp_button_skin_1);
	this.buttonSkinGroups.push(this.f_grp_button_skin_2);
	this.buttonSkinGroups.push(this.f_grp_button_skin_3);
	this.buttonSkinGroups.push(this.f_grp_button_skin_4);
	
	//group button buy item
	this.buttonBowGroups = new Array();
	this.buttonBowGroups.push(this.f_grp_button_bow_1);
	this.buttonBowGroups.push(this.f_grp_button_bow_2);
	this.buttonBowGroups.push(this.f_grp_button_bow_3);
	
	//Event buy Item
	this.fBtn_buy.onInputUp.add(this.onEventBuyItem,this);
	
	this.isManualUpdate = false;
	this.originBuySuccessPositionY =this.fTxt_buy_success_nofti.y ;

	//Load Data
	this.loadDataItem();
	
	
	this.groupSkins= new Array();
	this.groupSkins.push(this.fSkin_1);
	this.groupSkins.push(this.fSkin_2);
	this.groupSkins.push(this.fSkin_3);
	this.groupSkins.push(this.fSkin_4);
	this.groupSkins.push(this.fSkin_5);
	this.groupSkins.push(this.fSkin_6);
	this.groupSkins.push(this.fSkin_7);
	this.groupSkins.push(this.fSkin_8);
	this.groupSkins.push(this.fSkin_9);
	this.groupSkins.push(this.fSkin_10);
	this.groupSkins.push(this.fSkin_11);
	this.groupSkins.push(this.fSkin_12);
}
itemShopPrefab.prototype.loadDataItem = function() {
	if(localData.bowItem!= undefined){
		for(var i =0 ;i<localData.bowItem.length;i++){
			console.log("localData.bowItem[i] " +localData.bowItem[i]);
			this.buttonBowGroups[localData.bowItem[i]-1].visible = false;
		}
	}
	
	if(localData.skinItem!= undefined){
		for(var i =0 ;i<localData.skinItem.length;i++){
			console.log("localData.bowItem[i] " +localData.bowItem[i]);
			this.buttonSkinGroups[localData.skinItem[i]-1].visible = false;
		}
	}
	
	
	
}
itemShopPrefab.prototype.onEventBuyItem = function() {
	//down coin and save data
	localData.coins -= this.currentValueItem   ; 
	//update coin value to main menu 
	level.f_grpMainMenuPrefab.updateGemCoin(localData.gems,localData.coins);

	if(this.itemType === this.ITEMTYPE.SKIN){
		if(localData.skinItem ===undefined) localData.skinItem =new Array();
		localData.skinItem.push(this.currentItemIndex);
		//this.buttonSkinGroups[this.currentItemIndex].visible = false;
	}
	else if(this.itemType === this.ITEMTYPE.BOW){
		if(localData.bowItem ===undefined) localData.bowItem =new Array();
		localData.bowItem.push(this.currentItemIndex);
		//this.buttonBowGroups[this.currentItemIndex].visible = false;
	}
	
	//buy success
	level.f_grpInforPrefab.visible = true;
	level.f_grp_itemShop.visible = false;
	this.f_grp_buy_success_nofti.visible = false;
	this.isBuyItemNotification = false;
	this.f_grp_item_Shop.visible =false;
	this.f_grp_buy_nofti.visible = false;
	this.isManualUpdate = true;
	  level.f_grpInforPrefab.fTxt_buy_Success.visible = true;
	  setTimeout(function () {
		  level.f_grp_itemShop.f_grp_buy_success_nofti.visible = false;
		  level.f_grpInforPrefab.fTxt_buy_Success.visible = false;
	    },3000);
	
	//save data
	level.saveData();
	
	level.f_grpInforPrefab.onEventOpenInfor();
	//Load Item
	level.f_grpInforPrefab.loadItem();
	
	
}

itemShopPrefab.prototype.onEventCloseBuySuccess = function(bowIndex) {
	this.f_grp_buy_success_nofti.visible  = false;
	this.isBuyItemNotification = false;
}


itemShopPrefab.prototype.OnEventCancelBuy = function() {
	this.f_grp_buy_nofti.visible = false;
	this.isBuyItemNotification = false;
	this.f_grp_item_Shop.visible =false;
	level.f_grpInforPrefab.visible = true;
	level.f_grpInforPrefab.onEventOpenInfor();
	level.f_grp_itemShop.visible = false;
	
}

itemShopPrefab.prototype.onEventBuySkinItem = function(skinIndex) {
	if (this.isBuyItemNotification)return;
	// check coins
	if (this.checkValueCoins(this.costSkinItems[skinIndex])) {
		// Show UI Buy
		this.f_grp_buy_nofti.visible = true;
		this.isBuyItemNotification = true;
		this.fTxt_value_nofti.text = this.costSkinItems[skinIndex];
		this.currentValueItem = this.costSkinItems[skinIndex];
		this.itemType = this.ITEMTYPE.SKIN;
		this.currentItemIndex = skinIndex;
		this.f_grp_item_Shop.visible =false;
	}
	else{
		//when not enough coin open shop coin
		level.f_grp_IAP.visible = true;
		//level.f_grp_itemShop.visible = false;
		this.isBuyItemNotification = true;
	}
}

itemShopPrefab.prototype.onEventBuyBowItem = function(bowIndex) {
	if (this.isBuyItemNotification)return;
	// check coins
	if (this.checkValueCoins(this.costbowItems[bowIndex])) {
		// Show UI Buy
		this.f_grp_buy_nofti.visible = true;
		this.isBuyItemNotification = true;
		this.fTxt_value_nofti.text = this.costbowItems[bowIndex];
		this.currentValueItem = this.costbowItems[bowIndex];
		this.itemType = this.ITEMTYPE.BOW;
		this.currentItemIndex = bowIndex;
		this.f_grp_item_Shop.visible =false;
	}
	else{
		//when not enough coin open shop coin
		level.f_grp_IAP.visible = true;
		this.isBuyItemNotification = true;
	
	}
}



itemShopPrefab.prototype.checkValueCoins = function(value) {

	if (localData.coins >= value)
		return true;
	return false;
}

itemShopPrefab.prototype.OnEventOutFrame = function() {

	this.shopButtons[this.currentItemButton].animations.play("down");
}
itemShopPrefab.prototype.OnCloseShop = function() {
	level.f_grp_itemShop.visible = false;
	//Show Infor
	GlobalSetting.currentMenuState = MENUSTATE.INFOR ;
	level.f_grpLeaderBoardPrefab.scroller.kill();
	GlobalSetting.showPlayerInfor = true;
	level.onEventInfor();
	level.f_grpMainMenuPrefab.visibleButtonHome(false);
	level.f_grpMainMenuPrefab.visibleButtonControl(false);
	level.f_grpMapDuel.visible  = false;
	level.f_grpMapDuel.visibileMenuDuel(false);
	level.f_grpInforPrefab.onEventOpenInfor();
	
	
	

}
itemShopPrefab.prototype.OnEventSkin = function() {
	if (!this.activeControlButton(0))
		return;
	this.f_grp_Bow_Item.visible = false;
	this.f_grp_Skin_Item.visible = true;
}
itemShopPrefab.prototype.OnEventBow = function() {
	if (!this.activeControlButton(1))
		return;
	this.f_grp_Bow_Item.visible = true;
	this.f_grp_Skin_Item.visible = false;
}

itemShopPrefab.prototype.activeControlButton = function(indexControl) {

	this.currentItemButton = indexControl;

	if (this.currentItemButton === this.prevItemButton)
		return false;
	this.prevItemButton = this.currentItemButton;
	this.hideItemButton();
	this.shopButtons[indexControl].animations.play("down");
	return true;
}

itemShopPrefab.prototype.hideItemButton = function() {

	for (var i = 0; i < this.shopButtons.length; i++) {
		this.shopButtons[i].animations.play("up");
	}
}

itemShopPrefab.prototype.manualUpdate = function() {
	
	if(this.isManualUpdate){
	
	}
	
}



itemShopPrefab.prototype.updateTextAlignCenter = function() {

	this.fTxt_bow.x = this.fBtn_bow.x + this.fBtn_bow.width / 2;
	this.fTxt_skin.x = this.fBtn_skin.x + this.fBtn_skin.width / 2;

	this.fTxt_buy_nofti.x = this.fBG_not_enough_gems.x
			+ this.fBG_not_enough_gems.width / 2;
	this.fTxt_buy_btn.x = this.fBtn_buy.x + this.fBtn_buy.width / 2;
	this.fTxt_cancel_btn.x = this.fBtn_cancel_buy.x + this.fBtn_cancel_buy.width / 2;
}